(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[833],{5425:(e,s,a)=>{"use strict";a.d(s,{Bc:()=>n,ZI:()=>c,k$:()=>o,m_:()=>d});var t=a(26027),r=a(57307),i=a(56334),l=a(86383);let n=i.Kq,d=i.bL,o=i.l9,c=r.forwardRef((e,s)=>{let{className:a,sideOffset:r=4,...n}=e;return(0,t.jsx)(i.UC,{ref:s,sideOffset:r,className:(0,l.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...n})});c.displayName=i.UC.displayName},22041:(e,s,a)=>{Promise.resolve().then(a.bind(a,55239))},35420:(e,s,a)=>{"use strict";a.d(s,{p:()=>l});var t=a(26027),r=a(57307),i=a(86383);let l=r.forwardRef((e,s)=>{let{className:a,type:r,...l}=e;return(0,t.jsx)("input",{type:r,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:s,...l})});l.displayName="Input"},40722:(e,s,a)=>{"use strict";a.d(s,{T:()=>l});var t=a(26027),r=a(57307),i=a(86383);let l=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("textarea",{className:(0,i.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:s,...r})});l.displayName="Textarea"},52560:(e,s,a)=>{"use strict";a.d(s,{$:()=>o});var t=a(26027),r=a(57307),i=a(45415),l=a(96084),n=a(86383);let d=(0,l.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=r.forwardRef((e,s)=>{let{className:a,variant:r,size:l,asChild:o=!1,...c}=e,u=o?i.Slot:"button";return(0,t.jsx)(u,{className:(0,n.cn)(d({variant:r,size:l,className:a})),ref:s,...c})});o.displayName="Button"},55239:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>O});var t=a(26027),r=a(57307),i=a(9753),l=a(45684),n=a.n(l),d=a(52560),o=a(59586),c=a(35420),u=a(83226),m=a(75976),x=a(40722),p=a(86696),f=a(72660),h=a(75051),v=a(77489),j=a(5425),g=a(33067),b=a(48475),N=a(64494),y=a(98787),w=a(95774),C=a(78731),T=a(51063);let S=0,k=new Map,A=e=>{if(k.has(e))return;let s=setTimeout(()=>{k.delete(e),F({type:"REMOVE_TOAST",toastId:e})},1e6);k.set(e,s)},R=(e,s)=>{switch(s.type){case"ADD_TOAST":return{...e,toasts:[s.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===s.toast.id?{...e,...s.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=s;return a?A(a):e.toasts.forEach(e=>{A(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===s.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==s.toastId)}}},z=[],E={toasts:[]};function F(e){E=R(E,e),z.forEach(e=>{e(E)})}function I(e){let{...s}=e,a=(S=(S+1)%Number.MAX_SAFE_INTEGER).toString(),t=()=>F({type:"DISMISS_TOAST",toastId:a});return F({type:"ADD_TOAST",toast:{...s,id:a,open:!0,onOpenChange:e=>{e||t()}}}),{id:a,dismiss:t,update:e=>F({type:"UPDATE_TOAST",toast:{...e,id:a}})}}let M=async e=>{await new Promise(e=>setTimeout(e,500));let s=[{id:"1",name:"简单移动平均线 (SMA)",description:"计算特定周期内价格的算术平均值",category:"趋势",created:"2025-04-10",updated:"2025-05-02",status:"active",formula:"// 简单移动平均线计算函数\nfunction calculate(data, params) {\n  const period = params.period || 20;\n  const result = [];\n  \n  for (let i = 0; i < data.length; i++) {\n    if (i < period - 1) {\n      result.push(null);\n      continue;\n    }\n    \n    let sum = 0;\n    for (let j = 0; j < period; j++) {\n      sum += data[i - j].close;\n    }\n    result.push(sum / period);\n  }\n  \n  return result;\n}",parameters:[{id:"1",name:"period",label:"周期",defaultValue:"20",value:"20",type:"number",min:"2",max:"500",step:"1",description:"计算移动平均线的周期长度"}],visualization:{defaultColor:"#1E88E5",lineStyle:"solid",lineWidth:2,overlay:!0,position:"main"}},{id:"2",name:"指数移动平均线 (EMA)",description:"赋予近期价格更高权重的移动平均线",category:"趋势",created:"2025-03-15",updated:"2025-04-28",status:"active",formula:"// 指数移动平均线计算函数\nfunction calculate(data, params) {\n  const period = params.period || 14;\n  const result = [];\n  const multiplier = 2 / (period + 1);\n  \n  // 第一个EMA值使用SMA\n  let ema = 0;\n  for (let i = 0; i < period; i++) {\n    ema += data[i].close;\n  }\n  ema /= period;\n  result.push(ema);\n  \n  // 计算剩余的EMA值\n  for (let i = period; i < data.length; i++) {\n    ema = (data[i].close - ema) * multiplier + ema;\n    result.push(ema);\n  }\n  \n  return result;\n}",parameters:[{id:"1",name:"period",label:"周期",defaultValue:"14",value:"14",type:"number",min:"2",max:"500",step:"1",description:"计算指数移动平均线的周期长度"}],visualization:{defaultColor:"#43A047",lineStyle:"dashed",lineWidth:2,overlay:!0,position:"main"}},{id:"3",name:"相对强弱指标 (RSI)",description:"测量价格变化的速度和幅度，判断超买超卖状态",category:"动量",created:"2025-02-20",updated:"2025-04-15",status:"active",formula:"// RSI计算函数\nfunction calculate(data, params) {\n  const period = params.period || 14;\n  const overbought = params.overbought || 70;\n  const oversold = params.oversold || 30;\n  const result = [];\n  \n  // 计算价格变化\n  const changes = [];\n  for (let i = 1; i < data.length; i++) {\n    changes.push(data[i].close - data[i-1].close);\n  }\n  \n  // 计算RSI\n  for (let i = 0; i < changes.length; i++) {\n    if (i < period) {\n      result.push(null);\n      continue;\n    }\n    \n    let gains = 0;\n    let losses = 0;\n    \n    for (let j = i - period + 1; j <= i; j++) {\n      if (changes[j] >= 0) {\n        gains += changes[j];\n      } else {\n        losses -= changes[j];\n      }\n    }\n    \n    if (losses === 0) {\n      result.push(100);\n    } else {\n      const rs = gains / losses;\n      result.push(100 - (100 / (1 + rs)));\n    }\n  }\n  \n  return result;\n}",parameters:[{id:"1",name:"period",label:"周期",defaultValue:"14",value:"14",type:"number",min:"2",max:"500",step:"1",description:"计算RSI的周期长度"},{id:"2",name:"overbought",label:"超买阈值",defaultValue:"70",value:"70",type:"number",min:"50",max:"100",step:"1",description:"RSI超过此值视为超买状态"},{id:"3",name:"oversold",label:"超卖阈值",defaultValue:"30",value:"30",type:"number",min:"0",max:"50",step:"1",description:"RSI低于此值视为超卖状态"}],visualization:{defaultColor:"#E53935",lineStyle:"solid",lineWidth:2,overlay:!1,position:"separate"}}].find(s=>s.id===e);if(!s)throw Error("指标未找到");return s},_=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,s=[],a=100,t=new Date;t.setDate(t.getDate()-e);for(let r=0;r<e;r++){let e=new Date(t);e.setDate(e.getDate()+r);let i=a=Math.max(50,a+(Math.random()-.5)*2),l=a*(1+.02*Math.random()),n=a*(1-.02*Math.random()),d=a*(1+(Math.random()-.5)*.01),o=Math.floor(1e4*Math.random())+5e3;s.push({date:e.toISOString().split("T")[0],open:i,high:l,low:n,close:d,volume:o})}return s},V=(e,s,a)=>{try{let t={};return a.forEach(e=>{"number"===e.type?t[e.name]=Number.parseFloat(e.value):"boolean"===e.type?t[e.name]="true"===e.value:t[e.name]=e.value}),Function("data","params","\n      ".concat(s,"\n      return calculate(data, params);\n    "))(e,t)}catch(e){return console.error("计算指标时出错:",e),[]}},D=e=>{let{priceData:s,indicatorData:a,indicator:r}=e;return(0,t.jsx)("div",{className:"w-full h-[400px] bg-gray-50 dark:bg-gray-900 rounded-md p-4 relative",children:(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(g.A,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"图表预览区域 - 实际应用中这里会显示交互式图表"}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground mt-2",children:["指标: ",r.name," | 数据点: ",a.length," | 参数:",r.parameters.map(e=>" ".concat(e.label,"=").concat(e.value)).join(", ")]})]})})})};function O(e){var s;let{params:a}=e,l=(0,i.useRouter)(),{toast:g}=function(){let[e,s]=r.useState(E);return r.useEffect(()=>(z.push(s),()=>{let e=z.indexOf(s);e>-1&&z.splice(e,1)}),[e]),{...e,toast:I,dismiss:e=>F({type:"DISMISS_TOAST",toastId:e})}}(),[S,k]=(0,r.useState)(null),[A,R]=(0,r.useState)(!0),[O,W]=(0,r.useState)(!1),[Z,B]=(0,r.useState)(!1),[J,L]=(0,r.useState)([]),[$,P]=(0,r.useState)([]),[U,q]=(0,r.useState)("preview"),[Q,G]=(0,r.useState)("");r.useEffect(()=>{a.then(e=>G(e.id))},[a]),(0,r.useEffect)(()=>{Q&&(async()=>{try{R(!0);let e=await M(Q);k(e);let s=_(100);L(s);let a=V(s,e.formula,e.parameters);P(a)}catch(e){console.error("加载指标数据失败:",e),g({title:"加载失败",description:"无法加载指标数据，请稍后重试",variant:"destructive"})}finally{R(!1)}})()},[Q,g]);let H=(e,s)=>{if(!S)return;let a=S.parameters.map(a=>a.id===e?{...a,value:s}:a);k({...S,parameters:a})},K=()=>{S&&J.length&&(B(!0),setTimeout(()=>{try{let e=V(J,S.formula,S.parameters);P(e),g({title:"计算完成",description:"指标已根据新参数重新计算"})}catch(e){console.error("计算指标时出错:",e),g({title:"计算失败",description:"无法计算指标，请检查参数和公式",variant:"destructive"})}finally{B(!1)}},800))},X=async()=>{S&&(W(!0),await new Promise(e=>setTimeout(e,1e3)),console.log("保存指标配置:",S),g({title:"保存成功",description:"指标配置已更新"}),W(!1))};return A?(0,t.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin h-8 w-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"加载指标数据..."})]})}):S?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(n(),{href:"/indicators",children:(0,t.jsxs)(d.$,{variant:"ghost",size:"sm",children:[(0,t.jsx)(b.A,{className:"h-4 w-4 mr-1"}),"返回"]})}),(0,t.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:S.name}),(0,t.jsx)(v.E,{variant:"active"===S.status?"default":"secondary",children:"active"===S.status?"已激活":"草稿"})]}),(0,t.jsx)("p",{className:"text-muted-foreground",children:S.description})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(d.$,{variant:"outline",onClick:K,disabled:Z,children:[(0,t.jsx)(N.A,{className:"mr-2 h-4 w-4 ".concat(Z?"animate-spin":"")}),"重新计算"]}),(0,t.jsxs)(d.$,{onClick:X,disabled:O,children:[(0,t.jsx)(y.A,{className:"mr-2 h-4 w-4"}),O?"保存中...":"保存配置"]})]})]}),(0,t.jsxs)("div",{className:"grid gap-6 md:grid-cols-3",children:[(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)(o.Zp,{children:[(0,t.jsxs)(o.aR,{children:[(0,t.jsx)(o.ZB,{children:"基本信息"}),(0,t.jsx)(o.BT,{children:"指标的基本配置信息"})]}),(0,t.jsxs)(o.Wu,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u.J,{htmlFor:"name",children:"指标名称"}),(0,t.jsx)(c.p,{id:"name",value:S.name,onChange:e=>k({...S,name:e.target.value})})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u.J,{htmlFor:"description",children:"描述"}),(0,t.jsx)(x.T,{id:"description",value:S.description,onChange:e=>k({...S,description:e.target.value}),rows:3})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u.J,{htmlFor:"category",children:"分类"}),(0,t.jsxs)(m.l6,{value:S.category,onValueChange:e=>k({...S,category:e}),children:[(0,t.jsx)(m.bq,{id:"category",children:(0,t.jsx)(m.yv,{placeholder:"选择分类"})}),(0,t.jsxs)(m.gC,{children:[(0,t.jsx)(m.eb,{value:"趋势",children:"趋势"}),(0,t.jsx)(m.eb,{value:"动量",children:"动量"}),(0,t.jsx)(m.eb,{value:"波动率",children:"波动率"}),(0,t.jsx)(m.eb,{value:"成交量",children:"成交量"})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"space-y-0.5",children:[(0,t.jsx)(u.J,{htmlFor:"status",children:"激活状态"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"激活后可用于策略和回测"})]}),(0,t.jsx)(p.d,{id:"status",checked:"active"===S.status,onCheckedChange:e=>k({...S,status:e?"active":"draft"})})]})]})]}),(0,t.jsxs)(o.Zp,{children:[(0,t.jsxs)(o.aR,{className:"flex flex-row items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(o.ZB,{children:"参数设置"}),(0,t.jsx)(o.BT,{children:"调整指标计算参数"})]}),(0,t.jsx)(d.$,{variant:"outline",size:"sm",onClick:()=>{if(!S)return;let e=S.parameters.map(e=>({...e,value:e.defaultValue}));k({...S,parameters:e}),g({title:"参数已重置",description:"所有参数已恢复为默认值"})},children:"恢复默认值"})]}),(0,t.jsx)(o.Wu,{children:(0,t.jsx)("div",{className:"space-y-6",children:S.parameters.map(e=>(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(u.J,{htmlFor:"param-".concat(e.id),children:e.label}),(0,t.jsx)(j.Bc,{children:(0,t.jsxs)(j.m_,{children:[(0,t.jsx)(j.k$,{asChild:!0,children:(0,t.jsx)(w.A,{className:"h-4 w-4 text-muted-foreground"})}),(0,t.jsxs)(j.ZI,{children:[(0,t.jsx)("p",{children:e.description}),"number"===e.type&&(0,t.jsxs)("p",{className:"text-xs mt-1",children:["范围: ",e.min," - ",e.max,", 步长: ",e.step]})]})]})})]}),(0,t.jsxs)(v.E,{variant:"outline",children:["默认值: ",e.defaultValue]})]}),"number"===e.type&&(0,t.jsx)("div",{className:"space-y-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(c.p,{id:"param-".concat(e.id),type:"number",value:e.value,onChange:s=>H(e.id,s.target.value),min:e.min,max:e.max,step:e.step,className:"w-24"}),(0,t.jsx)(h.A,{value:[Number.parseFloat(e.value)],min:Number.parseFloat(e.min),max:Number.parseFloat(e.max),step:Number.parseFloat(e.step),onValueChange:s=>H(e.id,s[0].toString()),className:"flex-1"})]})}),"boolean"===e.type&&(0,t.jsx)(p.d,{id:"param-".concat(e.id),checked:"true"===e.value,onCheckedChange:s=>H(e.id,s.toString())}),"string"===e.type&&!e.options&&(0,t.jsx)(c.p,{id:"param-".concat(e.id),value:e.value,onChange:s=>H(e.id,s.target.value)}),"string"===e.type&&e.options&&(0,t.jsxs)(m.l6,{value:e.value,onValueChange:s=>H(e.id,s),children:[(0,t.jsx)(m.bq,{id:"param-".concat(e.id),children:(0,t.jsx)(m.yv,{placeholder:"选择选项"})}),(0,t.jsx)(m.gC,{children:(e.options||[]).map(e=>(0,t.jsx)(m.eb,{value:e.value,children:e.label},e.value))})]})]},e.id))})}),(0,t.jsx)(o.wL,{children:(0,t.jsxs)(d.$,{className:"w-full",onClick:K,disabled:Z,children:[(0,t.jsx)(N.A,{className:"mr-2 h-4 w-4 ".concat(Z?"animate-spin":"")}),"应用参数并重新计算"]})})]}),(0,t.jsxs)(o.Zp,{children:[(0,t.jsxs)(o.aR,{children:[(0,t.jsx)(o.ZB,{children:"可视化设置"}),(0,t.jsx)(o.BT,{children:"调整指标在图表上的显示方式"})]}),(0,t.jsxs)(o.Wu,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u.J,{htmlFor:"color",children:"指标颜色"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(c.p,{id:"color",type:"color",value:S.visualization.defaultColor,onChange:e=>k({...S,visualization:{...S.visualization,defaultColor:e.target.value}}),className:"w-16 h-10 p-1"}),(0,t.jsx)(c.p,{value:S.visualization.defaultColor,onChange:e=>k({...S,visualization:{...S.visualization,defaultColor:e.target.value}}),className:"flex-1"})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u.J,{htmlFor:"lineStyle",children:"线条样式"}),(0,t.jsxs)(m.l6,{value:S.visualization.lineStyle,onValueChange:e=>k({...S,visualization:{...S.visualization,lineStyle:e}}),children:[(0,t.jsx)(m.bq,{id:"lineStyle",children:(0,t.jsx)(m.yv,{placeholder:"选择线条样式"})}),(0,t.jsxs)(m.gC,{children:[(0,t.jsx)(m.eb,{value:"solid",children:"实线"}),(0,t.jsx)(m.eb,{value:"dashed",children:"虚线"}),(0,t.jsx)(m.eb,{value:"dotted",children:"点线"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u.J,{htmlFor:"lineWidth",children:"线条宽度"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(c.p,{id:"lineWidth",type:"number",value:S.visualization.lineWidth,onChange:e=>k({...S,visualization:{...S.visualization,lineWidth:Number.parseInt(e.target.value)}}),min:"1",max:"5",step:"1",className:"w-20"}),(0,t.jsx)(h.A,{value:[S.visualization.lineWidth],min:1,max:5,step:1,onValueChange:e=>k({...S,visualization:{...S.visualization,lineWidth:e[0]}}),className:"flex-1"})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u.J,{htmlFor:"position",children:"显示位置"}),(0,t.jsxs)(m.l6,{value:S.visualization.position,onValueChange:e=>k({...S,visualization:{...S.visualization,position:e}}),children:[(0,t.jsx)(m.bq,{id:"position",children:(0,t.jsx)(m.yv,{placeholder:"选择显示位置"})}),(0,t.jsxs)(m.gC,{children:[(0,t.jsx)(m.eb,{value:"main",children:"主图"}),(0,t.jsx)(m.eb,{value:"separate",children:"副图"})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between pt-2",children:[(0,t.jsxs)("div",{className:"space-y-0.5",children:[(0,t.jsx)(u.J,{htmlFor:"overlay",children:"叠加显示"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"与其他指标叠加显示"})]}),(0,t.jsx)(p.d,{id:"overlay",checked:S.visualization.overlay,onCheckedChange:e=>k({...S,visualization:{...S.visualization,overlay:e}})})]})]})]})]}),(0,t.jsx)("div",{className:"md:col-span-2",children:(0,t.jsxs)(o.Zp,{className:"h-full",children:[(0,t.jsx)(o.aR,{children:(0,t.jsx)(f.Tabs,{value:U,onValueChange:q,className:"w-full",children:(0,t.jsxs)(f.TabsList,{className:"grid grid-cols-3 w-full",children:[(0,t.jsx)(f.TabsTrigger,{value:"preview",children:"预览"}),(0,t.jsx)(f.TabsTrigger,{value:"code",children:"公式代码"}),(0,t.jsx)(f.TabsTrigger,{value:"data",children:"数据"})]})})}),(0,t.jsx)(o.Wu,{children:(0,t.jsxs)(f.Tabs,{value:U,onValueChange:q,className:"w-full",children:[(0,t.jsx)(f.TabsContent,{value:"preview",className:"mt-0",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(D,{priceData:J,indicatorData:$,indicator:S}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)(o.Zp,{children:[(0,t.jsx)(o.aR,{className:"py-4",children:(0,t.jsxs)(o.ZB,{className:"text-sm font-medium flex items-center",children:[(0,t.jsx)(C.A,{className:"h-4 w-4 mr-2 text-blue-500"}),"指标统计"]})}),(0,t.jsx)(o.Wu,{className:"py-2",children:(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-y-2 text-sm",children:[(0,t.jsx)("div",{className:"text-muted-foreground",children:"数据点数量:"}),(0,t.jsx)("div",{className:"font-medium",children:$.filter(e=>null!==e).length}),(0,t.jsx)("div",{className:"text-muted-foreground",children:"最大值:"}),(0,t.jsx)("div",{className:"font-medium",children:Math.max(...$.filter(e=>null!==e)).toFixed(2)}),(0,t.jsx)("div",{className:"text-muted-foreground",children:"最小值:"}),(0,t.jsx)("div",{className:"font-medium",children:Math.min(...$.filter(e=>null!==e)).toFixed(2)}),(0,t.jsx)("div",{className:"text-muted-foreground",children:"平均值:"}),(0,t.jsx)("div",{className:"font-medium",children:($.filter(e=>null!==e).reduce((e,s)=>e+s,0)/$.filter(e=>null!==e).length).toFixed(2)})]})})]}),(0,t.jsxs)(o.Zp,{children:[(0,t.jsx)(o.aR,{className:"py-4",children:(0,t.jsxs)(o.ZB,{className:"text-sm font-medium flex items-center",children:[(0,t.jsx)(T.A,{className:"h-4 w-4 mr-2 text-green-500"}),"窗口大小影响"]})}),(0,t.jsxs)(o.Wu,{className:"py-2",children:[(0,t.jsx)("div",{className:"text-sm text-muted-foreground mb-2",children:"窗口大小对指标计算的影响:"}),(0,t.jsxs)("ul",{className:"text-sm space-y-1",children:[(0,t.jsx)("li",{children:"• 较小的窗口: 对价格变化更敏感，但可能产生更多噪声"}),(0,t.jsx)("li",{children:"• 较大的窗口: 平滑效果更好，但对价格变化反应较慢"}),(0,t.jsxs)("li",{children:["• 当前窗口:"," ",(0,t.jsx)("span",{className:"font-medium",children:(null===(s=S.parameters.find(e=>"period"===e.name))||void 0===s?void 0:s.value)||"N/A"})]})]})]})]})]})]})}),(0,t.jsx)(f.TabsContent,{value:"code",className:"mt-0",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(x.T,{value:S.formula,onChange:e=>k({...S,formula:e.target.value}),className:"font-mono h-[500px] resize-none"}),(0,t.jsx)("div",{className:"absolute bottom-4 right-4",children:(0,t.jsxs)(d.$,{onClick:K,disabled:Z,size:"sm",children:[(0,t.jsx)(N.A,{className:"mr-2 h-3 w-3 ".concat(Z?"animate-spin":"")}),"应用代码并重新计算"]})})]}),(0,t.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-900 p-4 rounded-md",children:[(0,t.jsx)("h3",{className:"text-sm font-medium mb-2",children:"公式说明"}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:["编写一个名为 ",(0,t.jsx)("code",{children:"calculate"})," 的函数，接收两个参数:"]}),(0,t.jsxs)("ul",{className:"text-sm text-muted-foreground mt-2 space-y-1",children:[(0,t.jsxs)("li",{children:["• ",(0,t.jsx)("code",{children:"data"}),": 价格数据数组，每个元素包含 open, high, low, close, volume"]}),(0,t.jsxs)("li",{children:["• ",(0,t.jsx)("code",{children:"params"}),": 参数对象，包含用户设置的所有参数"]})]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:"函数应返回一个数组，表示计算出的指标值"})]})]})}),(0,t.jsx)(f.TabsContent,{value:"data",className:"mt-0",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("h3",{className:"text-sm font-medium",children:"计算结果数据"}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"显示前 100 条记录"})]}),(0,t.jsx)("div",{className:"border rounded-md",children:(0,t.jsx)("div",{className:"overflow-auto max-h-[500px]",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"bg-gray-50 dark:bg-gray-900",children:[(0,t.jsx)("th",{className:"text-left p-2 border-b",children:"日期"}),(0,t.jsx)("th",{className:"text-left p-2 border-b",children:"收盘价"}),(0,t.jsx)("th",{className:"text-left p-2 border-b",children:S.name})]})}),(0,t.jsx)("tbody",{children:J.slice(0,100).map((e,s)=>(0,t.jsxs)("tr",{className:"border-b last:border-0",children:[(0,t.jsx)("td",{className:"p-2",children:e.date}),(0,t.jsx)("td",{className:"p-2",children:e.close.toFixed(2)}),(0,t.jsx)("td",{className:"p-2",children:null!==$[s]?$[s].toFixed(2):"-"})]},s))})]})})})]})})]})}),(0,t.jsx)(o.wL,{className:"flex justify-end",children:(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(d.$,{variant:"outline",onClick:()=>l.push("/indicators"),children:"取消"}),(0,t.jsxs)(d.$,{onClick:X,disabled:O,children:[(0,t.jsx)(y.A,{className:"mr-2 h-4 w-4"}),O?"保存中...":"保存配置"]})]})})]})})]})]}):(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold mb-2",children:"指标未找到"}),(0,t.jsxs)("p",{className:"text-muted-foreground mb-6",children:["无法找到ID为 ",Q," 的指标"]}),(0,t.jsx)(n(),{href:"/indicators",children:(0,t.jsx)(d.$,{children:"返回指标列表"})})]})}},59586:(e,s,a)=>{"use strict";a.d(s,{BT:()=>o,Wu:()=>c,ZB:()=>d,Zp:()=>l,aR:()=>n,wL:()=>u});var t=a(26027),r=a(57307),i=a(86383);let l=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("div",{ref:s,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...r})});l.displayName="Card";let n=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("div",{ref:s,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",a),...r})});n.displayName="CardHeader";let d=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("div",{ref:s,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",a),...r})});d.displayName="CardTitle";let o=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("div",{ref:s,className:(0,i.cn)("text-sm text-muted-foreground",a),...r})});o.displayName="CardDescription";let c=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("div",{ref:s,className:(0,i.cn)("p-6 pt-0",a),...r})});c.displayName="CardContent";let u=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("div",{ref:s,className:(0,i.cn)("flex items-center p-6 pt-0",a),...r})});u.displayName="CardFooter"},72660:(e,s,a)=>{"use strict";a.d(s,{Tabs:()=>n,TabsContent:()=>c,TabsList:()=>d,TabsTrigger:()=>o});var t=a(26027),r=a(57307),i=a(18656),l=a(86383);let n=i.bL,d=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(i.B8,{ref:s,className:(0,l.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...r})});d.displayName=i.B8.displayName;let o=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(i.l9,{ref:s,className:(0,l.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...r})});o.displayName=i.l9.displayName;let c=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(i.UC,{ref:s,className:(0,l.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...r})});c.displayName=i.UC.displayName},75051:(e,s,a)=>{"use strict";a.d(s,{A:()=>n});var t=a(26027),r=a(57307),i=a(84757),l=a(86383);let n=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsxs)(i.bL,{ref:s,className:(0,l.cn)("relative flex w-full touch-none select-none items-center",a),...r,children:[(0,t.jsx)(i.CC,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:(0,t.jsx)(i.Q6,{className:"absolute h-full bg-primary"})}),(0,t.jsx)(i.zi,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]})});n.displayName=i.bL.displayName},75976:(e,s,a)=>{"use strict";a.d(s,{bq:()=>m,eb:()=>h,gC:()=>f,l6:()=>c,yv:()=>u});var t=a(26027),r=a(57307),i=a(43087),l=a(6112),n=a(86425),d=a(83418),o=a(86383);let c=i.bL;i.YJ;let u=i.WT,m=r.forwardRef((e,s)=>{let{className:a,children:r,...n}=e;return(0,t.jsxs)(i.l9,{ref:s,className:(0,o.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...n,children:[r,(0,t.jsx)(i.In,{asChild:!0,children:(0,t.jsx)(l.A,{className:"h-4 w-4 opacity-50"})})]})});m.displayName=i.l9.displayName;let x=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(i.PP,{ref:s,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",a),...r,children:(0,t.jsx)(n.A,{className:"h-4 w-4"})})});x.displayName=i.PP.displayName;let p=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(i.wn,{ref:s,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",a),...r,children:(0,t.jsx)(l.A,{className:"h-4 w-4"})})});p.displayName=i.wn.displayName;let f=r.forwardRef((e,s)=>{let{className:a,children:r,position:l="popper",...n}=e;return(0,t.jsx)(i.ZL,{children:(0,t.jsxs)(i.UC,{ref:s,className:(0,o.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:l,...n,children:[(0,t.jsx)(x,{}),(0,t.jsx)(i.LM,{className:(0,o.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,t.jsx)(p,{})]})})});f.displayName=i.UC.displayName,r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(i.JU,{ref:s,className:(0,o.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...r})}).displayName=i.JU.displayName;let h=r.forwardRef((e,s)=>{let{className:a,children:r,...l}=e;return(0,t.jsxs)(i.q7,{ref:s,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...l,children:[(0,t.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(i.VF,{children:(0,t.jsx)(d.A,{className:"h-4 w-4"})})}),(0,t.jsx)(i.p4,{children:r})]})});h.displayName=i.q7.displayName,r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(i.wv,{ref:s,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",a),...r})}).displayName=i.wv.displayName},77489:(e,s,a)=>{"use strict";a.d(s,{E:()=>n});var t=a(26027);a(57307);var r=a(96084),i=a(86383);let l=(0,r.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function n(e){let{className:s,variant:a,...r}=e;return(0,t.jsx)("div",{className:(0,i.cn)(l({variant:a}),s),...r})}},83226:(e,s,a)=>{"use strict";a.d(s,{J:()=>o});var t=a(26027),r=a(57307),i=a(64184),l=a(96084),n=a(86383);let d=(0,l.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(i.b,{ref:s,className:(0,n.cn)(d(),a),...r})});o.displayName=i.b.displayName},86383:(e,s,a)=>{"use strict";a.d(s,{cn:()=>i});var t=a(30050),r=a(86011);function i(){for(var e=arguments.length,s=Array(e),a=0;a<e;a++)s[a]=arguments[a];return(0,r.QP)((0,t.$)(s))}},86696:(e,s,a)=>{"use strict";a.d(s,{d:()=>n});var t=a(26027),r=a(57307),i=a(18824),l=a(86383);let n=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(i.bL,{className:(0,l.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",a),...r,ref:s,children:(0,t.jsx)(i.zi,{className:(0,l.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});n.displayName=i.bL.displayName}},e=>{var s=s=>e(e.s=s);e.O(0,[720,684,479,70,22,910,344,545,80,358],()=>s(22041)),_N_E=e.O()}]);